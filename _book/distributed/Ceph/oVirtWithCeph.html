<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>oVirt 与 Cinder 整合 | BLOG</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.5.0">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
        
    
    
    <link rel="next" href="../../life/README.html" />
    
    
    <link rel="prev" href="../../distributed/Ceph/README.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../../gitbook/style.css">


        
    <div class="book" data-level="7.1.1" data-basepath="../.." data-revision="1450943239282">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                        <i class="fa fa-check"></i>
                        
                         About me
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="problem/README.html">
            
                
                    <a href="../../problem/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         工作中遇到的问题
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="problem/update hostname list.html">
            
                
                    <a href="../../problem/update hostname list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         更新主机名
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="problem/systemdInFedora22.html">
            
                
                    <a href="../../problem/systemdInFedora22.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         无法开启 Fedora 22 上的所有服务
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="problem/proxychains-ng.html">
            
                
                    <a href="../../problem/proxychains-ng.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                         proxychains-ng 翻墙
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4" data-path="problem/newAptAndYumRepos.html">
            
                
                    <a href="../../problem/newAptAndYumRepos.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                         关于 Docker 更好的安装方式
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5" data-path="problem/dockerInFedora22.html">
            
                
                    <a href="../../problem/dockerInFedora22.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                         Docker 无法在 Fedora 22 上正常启动
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="python/README.html">
            
                
                    <a href="../../python/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Python 篇
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="python/stringVSrepr.html">
            
                
                    <a href="../../python/stringVSrepr.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         string 和 repr
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="Big Data/README.html">
            
                
                    <a href="../../Big Data/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Big Data
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1" data-path="Big Data/resources.html">
            
                
                    <a href="../../Big Data/resources.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         资源
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="docker/README.html">
            
                
                    <a href="../../docker/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Docker 篇
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1" >
            
                
                    <a target="_blank" href="https://yingyun001.gitbooks.io/docker_translation/content/">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         官文翻译
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="ansible/README.html">
            
                
                    <a href="../../ansible/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         Ansible 篇
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.1" data-path="ansible/ansibleHowToWork.html">
            
                
                    <a href="../../ansible/ansibleHowToWork.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                         Ansible 是如何工作的
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2" data-path="ansible/ansibleFromZeroToOne.html">
            
                
                    <a href="../../ansible/ansibleFromZeroToOne.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                         Ansible From Zero To One
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3" data-path="ansible/ansibleConfigManagement.html">
            
                
                    <a href="../../ansible/ansibleConfigManagement.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                         Ansible 之配置管理
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6" data-path="ovirt/README.html">
            
                
                    <a href="../../ovirt/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         oVirt 篇
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7" data-path="distributed/README.html">
            
                
                    <a href="../../distributed/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         存储
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1" data-path="distributed/Ceph/README.html">
            
                
                    <a href="../../distributed/Ceph/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                         Ceph
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter active" data-level="7.1.1" data-path="distributed/Ceph/oVirtWithCeph.html">
            
                
                    <a href="../../distributed/Ceph/oVirtWithCeph.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.1.</b>
                        
                         oVirt 与 Cinder 整合
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8" data-path="life/README.html">
            
                
                    <a href="../../life/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         生活
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.1" data-path="life/plan.html">
            
                
                    <a href="../../life/plan.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                         计划
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2" >
            
                
                    <a target="_blank" href="https://www.google.com.hk/?gws_rd=ssl">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                         书籍1
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.3" >
            
                
                    <a target="_blank" href="https://yaqi001.gitbooks.io/book/content/">
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                         书籍
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.4" data-path="life/goodStuff.html">
            
                
                    <a href="../../life/goodStuff.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                         妙
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5" data-path="life/think.html">
            
                
                    <a href="../../life/think.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                         想
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >BLOG</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_2">
                    
                        <h1 id="-ovirt--cinder">在 oVirt 中整合 Cinder</h1>
<p><strong>目录：</strong></p>
<ul>
<li><a href="#installation">安装</a><ul>
<li><a href="#preflight">准备</a><ul>
<li><a href="#CephDeploySetup">配置 Ceph Deploy</a></li>
<li><a href="#CephNodeSetup">配置 Ceph 节点</a></li>
</ul>
</li>
<li><a href="#StorageClusterQuickStart">存储集群之快速入门</a><ul>
<li><a href="#CreateCluster">创建集群</a></li>
<li><a href="#OperatingCluster">操作集群</a></li>
<li><a href="#ExpandingCluster">扩展集群</a></li>
<li><a href="#StoringRetrievingObjectData">存储/获取对象数据</a></li>
</ul>
</li>
<li><a href="#BlockDeviceQuickStart">块设备之快速入门</a><ul>
<li><a href="#CephInstallation">安装 Ceph</a></li>
<li><a href="#ConfigureABlockDevice">配置块设备</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>对于 OpenStack 了解甚少，刚开始看 Cinder 和 Ceph，真的是一头雾水。那么，就从官文看起吧！</p>
<h2 id="-ceph">先说说 Ceph</h2>
<h4 id="ceph-object-storagehttpdocscephcomdocsmasterglossaryterm-ceph-object-storage"><a href="http://docs.ceph.com/docs/master/glossary/#term-ceph-object-storage" target="_blank">Ceph Object Storage</a>：你可以称它为对象存储“产品”，服务或者一个功能。它主要包含了以下两个内容：</h4>
<ul>
<li><a href="http://docs.ceph.com/docs/master/rados/" target="_blank">Ceph Storage Cluster</a>：是整个 Ceph 部署中的基础，基于 <a href="http://ceph.com/papers/weil-rados-pdsw07.pdf" target="_blank">RADOS</a>，是核心存储软件之一，这里存储了用户的数据(MON + OSD)。部署 Ceph 存储集群的时候需要具备两种类型的后台程序：<a href="http://docs.ceph.com/docs/master/man/8/ceph-osd/" target="_blank">OSD</a> —— 将数据以对象的形式保存在存储节点上；&amp; <a href="http://docs.ceph.com/docs/v0.71/man/8/ceph-mon/" target="_blank">MON</a> —— 用于维护集群映射的原版拷贝。一个 Ceph 存储集群可以包含上千的存储节点。为了满足数据的拷贝，即便是 Ceph 存储集群的最小配置也要包含至少一个 MON 和两个 OSD 后台程序。<ul>
<li><a href="http://docs.ceph.com/docs/v0.79/rados/operations/monitoring/" target="_blank">Ceph Monitor</a>：Ceph Monitor 会持续更新 cluster 状态的 map，包括以下四个 map。Ceph 还维护了 Ceph Monitor，Ceph OSD 以及 Placement Group 中每次状态发生改变时的历史记录。<ul>
<li><a href="">monitor map</a></li>
<li><a href="">OSD map</a></li>
<li><a href="http://docs.ceph.com/docs/v0.69/rados/operations/placement-groups/" target="_blank">Placement Group map</a></li>
<li><a href="http://docs.ceph.com/docs/master/rados/operations/crush-map/" target="_blank">CRUSH map</a>：</li>
</ul>
</li>
<li><a href="http://docs.ceph.com/docs/master/man/8/ceph-osd/" target="_blank">Ceph OSD Daemon</a>：用于存储数据；处理数据的同步，恢复数据，保持数据连续性(backfilling 是回填的意思，具体意思参考了<a href="http://www.aussiestockforums.com/forums/showthread.php?t=19759" target="_blank">这里</a>)以及使数据达到平衡的状态；在每次 Heartbeat 的时候对其它 Ceph OSD 后台程序进行检查从而为 Ceph Monitor 提供一些监控数据。如果集群为您的数据做了两份拷贝，那 Ceph Storage Cluster 需要至少两个 Ceph OSD 后台程序才能达到 active + clean 的状态（<strong>什么是 active + clean 状态..o.O</strong>）。</li>
</ul>
</li>
</ul>
<ul>
<li><a href="http://docs.ceph.com/docs/master/radosgw/" target="_blank">Ceph Object Gateway</a>：是构建在 <code>librados</code> 之上的对象存储接口，用来给应用程序提供 Ceph 存储集群的 RESTful gateway.这里支持以下两种接口；Ceph Object Storage 利用 Ceph Object Gateway 后台程序(<strong><a href="http://docs.ceph.com/docs/v0.69/man/8/radosgw/" target="_blank">radosgw</a></strong>)，radosgw 是用于和 Ceph Storage Cluster 进行交互的 FastCGI 模块。<ul>
<li><strong>S3-compatible</strong>：兼容了 Amazon S3 RESTful API 的接口提供了对象存储的功能。</li>
<li><strong>Swift-compatible</strong>：兼容了 OpenStack Swift API 的接口提供了对想存储的功能。</li>
</ul>
</li>
</ul>
<h4 id="ceph-block-devicehttpdocscephcomdocsmasterrbdrbd-512-cd-9-track--ceph-ceph--ceph-cluster--osd-ceph--radoshttpdocscephcomdocsgiantman8radosceph--rados-rbd-librbd--osd-"><a href="http://docs.ceph.com/docs/master/rbd/rbd/" target="_blank">Ceph Block Device</a>：块就是一个字节序列（例如，一个 512 字节的数据块）。那么基于块的存储接口就是用传统的旋转存储接口（例如：硬盘，CD，软盘甚至是传统 9-track 磁带）存储数据的最常见的方式。块设备的普遍存在使得一个虚拟块设备成为能够与像 Ceph 这样的大量数据存储系统进行通信的最佳候选者。Ceph 块设备是精简配置且可调整大小的，还可以在一个 Ceph Cluster 上的多个 OSD 上存储带状数据。Ceph 块设备利用了 <a href="http://docs.ceph.com/docs/giant/man/8/rados/" target="_blank">RADOS</a>功能，例如快照，复制，保证数据一致性。Ceph 的 [RADOS] 块设备（RBD）利用内核或者 [librbd] 库来和 OSD 进行通信。</h4>
<h4 id="ceph-filesystemhttpdocscephcomdocsmastercephfsceph-fs-posix--ceph-storage-cluster-ceph--ceph-block-devices--ceph-object-storage--ceph-storage-cluster--s3-swift-api-librados-ceph--ceph-storage-cluster--ceph-metadata-serverhttpdocscephcomdocsv071man8ceph-mds"><a href="http://docs.ceph.com/docs/master/cephfs/" target="_blank">Ceph Filesystem</a>（Ceph FS）是一个兼容了 POSIX 的文件系统，它利用 Ceph Storage Cluster 来存储数据。Ceph 文件系统像 Ceph Block Devices 和 Ceph Object Storage 一样使用 Ceph Storage Cluster 和 S3， Swift API 或者本地邦定（librados）。要想使用 Ceph 文件系统，你的 Ceph Storage Cluster 中至少得有一个 <a href="http://docs.ceph.com/docs/v0.71/man/8/ceph-mds/" target="_blank">Ceph Metadata Server</a>。</h4>
<ul>
<li><a href="http://docs.ceph.com/docs/v0.71/man/8/ceph-mds/" target="_blank">Ceph Metadata Server</a>：MDS，Ceph 元数据软件。MDS 代表 Ceph 文件系统存储了元数据（Ceph Block Devices 和 Ceph Object Storage 则不用 MDS）。Ceph Metadata Server 能够让 POSIX 文件系统用户执行基本命令例如 <code>ls</code>，<code>find</code> 等，为 Ceph Storage Cluster 减轻了很多负担。</li>
</ul>
<h2 id="">一些术语：</h2>
<ul>
<li><a href="http://docs.ceph.com/docs/giant/rados/api/librados-intro/" target="_blank">librados</a>：提供了基础服务 —— 允许 Ceph 在一个存储系统中提供对象存储，块存储和文件存储。然而，你除了可以使用 RESTful，块或者 POSIX 接口外，还有另外一种选择，librados API 允许你基于 RADOS 为 Ceph Storage Cluster 自定义接口。librados API 允许你和 Ceph Storage Cluster 中的两类后台程序进行交互。<ul>
<li>Ceph Monitor —— 维护集群映射的原版拷贝。</li>
<li>Ceph OSD Daemon —— 将数据以对象的形式存储到存储节点。</li>
</ul>
</li>
<li>replication： 计算机领域给出的定义是分享数据，确保数据在硬件或者软件组件上保持一致性，从而提高了数据的可依赖性，容错性和可读性。IBM 给出的<a href="https://www-01.ibm.com/software/data/replication/" target="_blank">解释</a></li>
<li><a href="https://en.wikipedia.org/wiki/Data_recovery" target="_blank">recovery</a>：</li>
<li>backfilling：(<a href="http://www.aussiestockforums.com/forums/showthread.php?t=19759" target="_blank">http://www.aussiestockforums.com/forums/showthread.php?t=19759</a>)</li>
<li><a href="http://drbd.linbit.com/users-guide-9.0/s-rebalance-workflow.html" target="_blank">rebalancing</a></li>
<li>active + clean：</li>
<li><a href="http://linux-ha.org/wiki/Heartbeat" target="_blank">heartbeat</a>：</li>
<li><a href="http://recoveryspecialties.com/dc01.html" target="_blank">data consistency</a>：指的是数据的可用性，在单一的环境中它被认为是理所当然存在的。一般在单一环境中进行数据备份（生产数据的副本用在原始数据领域中的时候）的时候会发生 data consistency。</li>
<li>[]</li>
</ul>
<h2 id="installation">安装</h2>

<h3 id="preflight">准备</h3>

<p>操作系统： CentOS 7</p>
<table>
<thead>
<tr>
<th><strong>node 名称</strong></th>
<th><strong>IP 地址</strong></th>
<th><strong>作用</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ceph-deploy-admin-node</td>
<td>192.168.9.59</td>
<td>管理其它 Ceph 节点的 node</td>
</tr>
<tr>
<td>ceph-node1</td>
<td>192.168.9.58</td>
<td>管理 Ceph Storage cluster</td>
</tr>
<tr>
<td>ceph-node2</td>
<td>192.168.9.57</td>
<td>管理 Ceph Storage cluster</td>
</tr>
<tr>
<td>ceph-node3</td>
<td>192.168.9.55</td>
<td>管理 Ceph Storage cluster</td>
</tr>
</tbody>
</table>
<h4 id="startInstall">配置 Ceph Deploy</h4>

<ol>
<li><p>在 <code>ceph-deploy</code> 中添加 Ceph 仓库：</p>
<pre><code class="lang-bash"><span class="hljs-comment"># cat &gt;/etc/yum.repos.d/ceph.repo &lt;&lt;EOF</span>
&gt; [ceph-noarch]
&gt; name=Ceph noarch packages
&gt; baseurl=http://download.ceph.com/rpm-hammer/el7/noarch
&gt; enabled=<span class="hljs-number">1</span>
&gt; gpgcheck=<span class="hljs-number">1</span>
&gt; <span class="hljs-built_in">type</span>=rpm-md
&gt; gpgkey=https://download.ceph.com/keys/release.asc
&gt; EOF
</code></pre>
<blockquote>
<p><strong>提示：</strong><br/></p>
<ul>
<li><code>hammer</code> 是 Ceph 的版本名称，你可以修改为最近主要的版本名称，需要注意的是版本名称应该写成小些形式。Ceph 的版本信息：<a href="http://ceph.com/category/releases/" target="_blank">http://ceph.com/category/releases/</a>。</li>
<li><code>el7</code> 指的是我使用的 Linux 发行版。对应关系如下：<table>
   <tr>
      <td>el6</td>
      <td>CentOS 6</td>
   </tr>
   <tr>
      <td>el7</td>
      <td>CentOS 7</td>
   </tr>
   <tr>
      <td>rhel6</td>
      <td>Red Hat 6.5</td>
   </tr>
   <tr>
      <td>rhel7</td>
      <td>Red Hat 7</td>
   </tr>
   <tr>
      <td>fc19</td>
      <td>Fedora 19</td>
   </tr>
   <tr>
      <td>fc20</td>
      <td>Fedora 20</td>
   </tr>
</table>
</li>
</ul>
</blockquote>
</li>
<li><p>更新系统，并安装 ceph-deploy </p>
<pre><code class="lang-bash">$ <span class="hljs-built_in">sudo</span> yum -y update
$ <span class="hljs-built_in">sudo</span> yum -y install ceph-deploy
</code></pre>
</li>
</ol>
<h4 id="CephNodeSetup">配置 Ceph 节点</h4>

<ol>
<li><p>安装 NTP（Network Time Protocol）</p>
<p>建议在 Ceph node（尤其是 Ceph 监控节点）上安装 NTP，这样可以避免出现由于时间差异产生的各种问题。</p>
<pre><code class="lang-bash"><span class="hljs-built_in">sudo</span> yum -y install ntp ntpdate ntp-doc
</code></pre>
</li>
<li><p>安装 SSH 服务</p>
<pre><code class="lang-bash">yum -y install openssh-server
systemctl start sshd
</code></pre>
</li>
<li><p>为 <code>ceph-deploy</code> 端创建用户
<code>ceph-deploy</code> 工具必须要以一个无密码 <strong>sudo</strong> 权限的用户登录到其它的 <code>ceph-node</code> 端，这是因为 <code>ceph-deploy</code> 这个工具需要在无密码提示的情况下安装软件并配置相关文件。</p>
<p>最新的 <code>ceph-deply</code> 的版本支持 <code>--username</code> 选项，所以你完全可以通过指定某个具有无密码 <strong>sudo</strong> 权限的用户（包括 root 用户，即便我们并不支持这么做）对其它 <code>ceph-node</code> 进行操作。建议在所有 <code>ceph-node</code> 上都创建该用户，这样一来就方便多了，但是最好不要用 <code>ceph</code> 作为你指定的用户名称。</p>
<ol>
<li><p>在每个 ceph 节点上都创建一个新用户：
我新创建的用户名是 <code>Ceph</code></p>
<pre><code class="lang-bash">$ <span class="hljs-built_in">sudo</span> useradd <span class="hljs-operator">-d</span> /home/Ceph -m Ceph
$ <span class="hljs-built_in">sudo</span> passwd Ceph
</code></pre>
</li>
<li><p>为所有 ceph 节点上的新用户添加 <code>sudo</code> 权限： </p>
<pre><code class="lang-bash">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Ceph ALL = (root) NOPASSWD:ALL"</span> | <span class="hljs-built_in">sudo</span> tee /etc/sudoers.d/Ceph
$ <span class="hljs-built_in">sudo</span> chmod <span class="hljs-number">0440</span> /etc/sudoers.d/Ceph
</code></pre>
</li>
</ol>
</li>
<li><p>开启无密码 SSH</p>
<ol>
<li><p>使用你刚刚创建的新用户生成 SSH 密钥，口令设为空：</p>
<pre><code class="lang-bash">[Ceph@ceph-deploy-admin-node helen]$ ssh-keygen
Generating public/private rsa key pair.
Enter file <span class="hljs-keyword">in</span> which to save the key (/home/Ceph/.ssh/id_rsa): 
Created directory <span class="hljs-string">'/home/Ceph/.ssh'</span>.
Enter passphrase (empty <span class="hljs-keyword">for</span> no passphrase): 
Enter same passphrase again: 
Your identification has been saved <span class="hljs-keyword">in</span> /home/Ceph/.ssh/id_rsa.
Your public key has been saved <span class="hljs-keyword">in</span> /home/Ceph/.ssh/id_rsa.pub.
The key fingerprint is:
<span class="hljs-number">41</span>:a6:<span class="hljs-number">62</span>:<span class="hljs-number">50</span>:<span class="hljs-number">7</span>f:<span class="hljs-number">79</span>:<span class="hljs-number">95</span>:c0:<span class="hljs-number">88</span>:<span class="hljs-number">55</span>:<span class="hljs-number">4</span>e:b8:<span class="hljs-number">0</span>f:<span class="hljs-number">0</span>d:<span class="hljs-number">3</span>f:<span class="hljs-number">75</span> Ceph@ceph-deploy-admin-node
The key<span class="hljs-string">'s randomart image is:
+--[ RSA 2048]----+
|  ...  o+=+...   |
|   . ..+++..o E  |
|    o o +=o. .   |
|   . . .oo+      |
|        So .     |
|          .      |
|                 |
|                 |
|                 |
+-----------------+</span>
</code></pre>
</li>
<li><p>将密钥拷贝到其它三个 Ceph 节点中：</p>
<pre><code class="lang-bash">[Ceph@ceph-deploy-admin-node ~]$ ssh-copy-id Ceph@ceph-node1
The authenticity of host <span class="hljs-string">'ceph-node1 (192.168.9.58)'</span> can<span class="hljs-string">'t be established.
ECDSA key fingerprint is 49:b1:e8:e6:5a:fb:a9:ac:a1:d0:ae:8a:2b:da:12:f7.
Are you sure you want to continue connecting (yes/no)? yes
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
Ceph@ceph-node1'</span>s password: 

Number of key(s) added: <span class="hljs-number">1</span>

Now try logging into the machine, with:   <span class="hljs-string">"ssh 'Ceph@ceph-node1'"</span>
and check to make sure that only the key(s) you wanted were added.
</code></pre>
<pre><code class="lang-bash"><span class="hljs-comment"># ceph-node2 和 ceph-node3 同理</span>
ssh-copy-id Ceph@ceph-node2
ssh-copy-id Ceph@ceph-node3
</code></pre>
<blockquote>
<p><strong>注意：</strong>：由于后面会用到 ceph 客户端，所以最好在 ceph-node1, ceph-node2, ceph-node3 之间也实现无密码登录，重复上面的步骤既可。</p>
</blockquote>
</li>
</ol>
</li>
<li><p>开机时启动网络</p>
<p>Ceph OSD 是相互对等的，且它们都通过网络向 Ceph Monitors 进行报告。如果默认情况下网络是关闭的状态，那么 Ceph Cluster 是不能够进行网络通信的。</p>
<p>CentOS 7 默认的网络接口中配置的网络默认情况下是关闭的。您可以在 <code>/etc/sysconfig/network-scripts</code> 目录下的 <code>/etc/ifcfg-eth0</code> （eth0 是我的网卡名称）文件中将 <code>ONBOOT</code> 设置为 <code>yes</code>。</p>
</li>
<li><p>确保连接性</p>
<p>使用 ping 某台机器 IP 或主机名的方式来检测机器是否已经连网。如果用的是主机名，不要忘记配置本地 DNS。</p>
</li>
<li><p>打开所需的端口</p>
<table>
     <tr>
        <td>服务</td>
        <td>默认端口</td>
     </tr>
     <tr>
        <td>Ceph Monitor</td>
        <td>6789</td>
     </tr>
     <tr>
        <td>Ceph OSD</td>
        <td>6800:7300</td>
     </tr>
</table>

<p>Ceph OSD 可以使用多个网络连接来和客户端，Ceph Monitor，用于复制的 OSD，以及用于监控的心跳 OSD。</p>
<ol>
<li><p>首先确保 <code>firewalld</code> 已经打开：</p>
<pre><code class="lang-bash">systemctl start firewalld
systemctl enable firewalld
</code></pre>
</li>
<li><p>CentOS 7 默认的 <code>firewall</code> 配置相对严格。如若想要在 Ceph 客户端上与 Ceph node 进行通信，你必须调整 firewall 的设置。</p>
<pre><code class="lang-bash">$ <span class="hljs-built_in">sudo</span> firewall-cmd --zone=public --add-port=<span class="hljs-number">6789</span>/tcp --permanent
success
$ <span class="hljs-built_in">sudo</span> firewall-cmd --zone=public --add-port=<span class="hljs-number">6800</span>-<span class="hljs-number">7300</span>/tcp --permanent 
success
</code></pre>
</li>
</ol>
</li>
<li><p>关闭 <code>SELINUX</code>：</p>
<p>为了简化安装，我们建议您设置 <code>SELINUX</code> 的权限或者直接关掉它。在关闭 <code>SELINUX</code> 之前，请确保 node 是可以正常使用的。</p>
<pre><code class="lang-bash"><span class="hljs-built_in">sudo</span> setenforce <span class="hljs-number">0</span>
</code></pre>
</li>
<li><p>设置调用源时的优先级： </p>
<ol>
<li>确保你的包管理器有安装好的优先级包。CentOS 中还需要安装 EPEL。<pre><code class="lang-bash"><span class="hljs-built_in">sudo</span> yum -y install yum-plugin-priorities
<span class="hljs-built_in">sudo</span> yum -y install epel
</code></pre>
</li>
</ol>
</li>
</ol>
<h3 id='StorageClusterQuickStart'>存储集群之快速入门</h3>

<p>这里我们利用 ceph-deploy-admin-node 上的 <code>ceph-deploy</code> 来设置 Ceph Storage Cluster。创建一个具有三个节点的集群之后你就可以继续挖掘 Ceph 的功能了。创建一个 Ceph Monitor <em> 1 + Ceph OSD Daemon </em> 2 的集群。一旦 cluster 达到了 <code>active + clean</code> 的状态后，就可以通过添加第三个 OSD，添加 MDS 或者添加至少两个的 Ceph Monitor 来扩展它了^.^。</p>
<blockquote>
<p><strong>提示</strong>：最好在管理节点上创建一个新的目录来保存 <code>ceph-deploy</code> 为集群生成的配置文件和 keys。</p>
<pre><code class="lang-bash">  $ mkdir my-cluster
  $ <span class="hljs-built_in">cd</span> my-cluster/
</code></pre>
<p><strong>注意</strong>：<code>ceph-deploy</code> 工具会将输出目录存放至 <code>my-cluster</code> 目录中，所以你需要在该目录下执行 <code>ceph-deploy</code> 命令。</p>
</blockquote>
<h4 id='CreateCluster'>创建集群</h4>

<ol>
<li><p>如果你的操作对集群造成了不可挽回的损毁，你想要重新来一遍怎么办呢？执行下面的命令来清理你的配置信息：</p>
<pre><code class="lang-bash"><span class="hljs-comment"># {ceph-node} 用于替换非管理节点的主机名</span>
$ ceph-deploy purgedata {ceph-node} [{ceph-node}]
$ ceph-deploy forgetkeys
</code></pre>
<p>想要清理 Ceph 包，请执行如下操作：</p>
<pre><code class="lang-bash">$ ceph-deploy purge {ceph-node} [{ceph-node}]
</code></pre>
<blockquote>
<p><strong>注意</strong>：执行了 <code>purge</code> 之后，你必须要再安装一遍 <code>Ceph</code>。</p>
</blockquote>
<p>在管理节点的新创建的 <code>my-cluster</code> 目录下利用 <code>ceph-deploy</code> 工具执行如下操作：</p>
</li>
<li><p>开始部署新的集群，并为其生成集群配置文件和 keyring</p>
<pre><code class="lang-bash"><span class="hljs-comment"># 初始化作为监控节点的 ceph-node1</span>
[Ceph@ceph-deploy-admin-node my-cluster]$ ceph-deploy new ceph-node1
</code></pre>
<p>这时你可以看到 <code>my-cluster</code> 中出现了三个新的文件</p>
<pre><code class="lang-bash">[Ceph@ceph-deploy-admin-node my-cluster]$ ll
总用量 <span class="hljs-number">16</span>
-rw-rw-r--. <span class="hljs-number">1</span> Ceph Ceph  <span class="hljs-number">232</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">11</span>:<span class="hljs-number">30</span> ceph.conf <span class="hljs-comment"># Ceph 的配置文件</span>
-rw-rw-r--. <span class="hljs-number">1</span> Ceph Ceph <span class="hljs-number">6741</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">11</span>:<span class="hljs-number">30</span> ceph.log <span class="hljs-comment"># 新集群的日志文件</span>
-rw-------. <span class="hljs-number">1</span> Ceph Ceph   <span class="hljs-number">73</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">11</span>:<span class="hljs-number">30</span> ceph.mon.keyring <span class="hljs-comment"># 监控节点的秘密密钥</span>
</code></pre>
</li>
<li><p>Ceph 配置文件中默认的 OSD 的数量是 3，我们需要把它改成 2，才能达到在只有两个 Ceph OSD 的情况下保持 <code>active + clean</code> 的状态。将下面一行添加到 <code>[global]</code> 部分中。</p>
<pre><code class="lang-bash">osd pool default size = <span class="hljs-number">2</span>
</code></pre>
</li>
<li><p>安装 Ceph</p>
<pre><code class="lang-bash">$ ceph-deploy install ceph-deploy-admin-node ceph-node1 ceph-node2 ceph-node3
</code></pre>
<p><code>ceph-deploy</code> 工具将会在每个 Ceph 节点上安装 Ceph。</p>
<blockquote>
<p><strong>注意</strong>：如果你执行了 <code>ceph-deploy purge</code> 这个命令，你必须重新执行该指令以重装 <code>Ceph</code>。</p>
</blockquote>
</li>
<li><p>添加初始化的监控节点，并生成密钥</p>
<pre><code class="lang-bash">[Ceph@ceph-deploy-admin-node my-cluster]$ ceph-deploy mon create-initial
</code></pre>
<p>以上命令完成后，你会发现 <code>my-cluster</code> 目录下多了几个 key 文件出来：</p>
<pre><code class="lang-bash">总用量 <span class="hljs-number">220</span>
-rw-------. <span class="hljs-number">1</span> Ceph Ceph     <span class="hljs-number">71</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">29</span> ceph.bootstrap-mds.keyring
-rw-------. <span class="hljs-number">1</span> Ceph Ceph     <span class="hljs-number">71</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">29</span> ceph.bootstrap-osd.keyring
-rw-------. <span class="hljs-number">1</span> Ceph Ceph     <span class="hljs-number">71</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">29</span> ceph.bootstrap-rgw.keyring <span class="hljs-comment"># 只有集群是 Hammer 或以上版本的时候才会有 bootstrap-rgw keyring</span>
-rw-------. <span class="hljs-number">1</span> Ceph Ceph     <span class="hljs-number">63</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">29</span> ceph.client.admin.keyring
-rw-rw-r--. <span class="hljs-number">1</span> Ceph Ceph    <span class="hljs-number">257</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">11</span>:<span class="hljs-number">57</span> ceph.conf
-rw-rw-r--. <span class="hljs-number">1</span> Ceph Ceph <span class="hljs-number">154469</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">34</span> ceph.log
-rw-------. <span class="hljs-number">1</span> Ceph Ceph     <span class="hljs-number">73</span> <span class="hljs-number">11</span>月 <span class="hljs-number">24</span> <span class="hljs-number">11</span>:<span class="hljs-number">30</span> ceph.mon.keyring
</code></pre>
</li>
<li><p>添加两个 OSD</p>
<ol>
<li><p>如果想要快速配置，就不必使用 Ceph OSD 的整个磁盘了，只用一个目录即可。登录到 Ceph 的 OSD 节点并为 OSD 后台程序创建一个目录。</p>
<pre><code class="lang-bash">[Ceph@ceph-node2 ~]$ <span class="hljs-built_in">sudo</span> mkdir /var/local/osd0
[Ceph@ceph-node3 ~]$ <span class="hljs-built_in">sudo</span> mkdir /var/local/osd1
</code></pre>
</li>
<li><p>使用 Ceph 管理节点上的 <code>ceph-deploy</code> 添加两个 OSD</p>
<pre><code class="lang-bash">[Ceph@ceph-deploy-admin-node my-cluster]$ ceph-deploy osd prepare ceph-node2:/var/local/osd0 ceph-node3:/var/local/osd1
</code></pre>
</li>
<li><p>激活 OSD</p>
<pre><code class="lang-bash">[Ceph@ceph-deploy-admin-node my-cluster]$ ceph-deploy osd activate ceph-node2:/var/local/osd0 ceph-node3:/var/local/osd1
</code></pre>
</li>
<li><p>利用 <code>ceph-deploy</code> 工具将配置文件和 admin 密钥拷贝到你的 Ceph 管理节点（ceph-deploy-admin-node）&amp; Ceph 非管理节点（ceph-node1, ceph-node2, ceph-node3）上，这样一来，当你使用 ceph 客户端执行某条指令的时候就无需指定监控节点地址和 <code>ceph.client.admin.keyring</code> 了。</p>
<pre><code class="lang-bash">[Ceph@ceph-deploy-admin-node my-cluster]$ ceph-deploy admin ceph-deploy-admin-node ceph-node1 ceph-node2 ceph-node3
</code></pre>
<blockquote>
<p><strong>注意</strong>：不要忘记在 Ceph 管理节点中的 <code>/etc/hosts/</code> 目录中配置本机域名。</p>
</blockquote>
</li>
<li><p>为每个节点中的 <code>ceph.client.admin.keyring</code> 文件添加可读权限</p>
<pre><code class="lang-bash">$ <span class="hljs-built_in">sudo</span> chmod +r /etc/ceph/ceph.client.admin.keyring
</code></pre>
</li>
<li><p>测试集群是否创建成功</p>
<pre><code class="lang-bash">$ ceph health
</code></pre>
<p><strong>Your cluster should return an active + clean state when it has finished peering.</strong></p>
</li>
</ol>
</li>
</ol>
<h4 id='OperatingCluster'>操作集群</h4>

<ol>
<li><p>操作集群的后台程序（OSD）：</p>
<ol>
<li><p>开启所有的后台程序
通过执行 ceph start 命令开启 Ceph 集群：</p>
<pre><code class="lang-bash"><span class="hljs-built_in">sudo</span> /etc/init.d/ceph <span class="hljs-operator">-a</span> start
[Ceph@ceph-deploy-admin-node my-cluster]$ <span class="hljs-built_in">sudo</span> /etc/init.d/ceph <span class="hljs-operator">-a</span> start
=== osd.<span class="hljs-number">0</span> === 
root@ceph-node2<span class="hljs-string">'s password: 
root@ceph-node2'</span>s password: 
Starting Ceph osd.<span class="hljs-number">0</span> on ceph-node2...already running
=== osd.<span class="hljs-number">1</span> === 
root@ceph-node3<span class="hljs-string">'s password: 
root@ceph-node3'</span>s password: 
df: <span class="hljs-string">"/var/lib/ceph/osd/ceph-1/."</span>: 没有那个文件或目录
root@ceph-node3<span class="hljs-string">'s password: 
create-or-move updated item name '</span>osd.<span class="hljs-number">1</span><span class="hljs-string">' weight 1 at location {host=ceph-deploy-admin-node,root=default} to crush map
Starting Ceph osd.1 on ceph-node3...
root@ceph-node3'</span>s password: 
Running as unit run-<span class="hljs-number">19894</span>.service.
</code></pre>
<p><code>-a</code> 意味着对所有节点执行这条指令。</p>
<blockquote>
<p><strong>提醒</strong>：如果你不想每次都输入密码，请使用 SSH 无密码登录的方式：</p>
<pre><code>        ~~~ bash
        sudo ssh-keygen
        sudo ssh-copy-id -i /root/.ssh/id_rsa.pub root@ceph-node1
        sudo ssh-copy-id -i /root/.ssh/id_rsa.pub root@ceph-node2
        sudo ssh-copy-id -i /root/.ssh/id_rsa.pub root@ceph-node1
        ~~~
</code></pre></blockquote>
</li>
<li><p>开启不同类型的后台程序：</p>
<ul>
<li><p>想在本地 Ceph 节点开启同一类型的后台程序：
例如 <code>ceph-node3</code> 上只运行了 osd.1：</p>
<pre><code class="lang-bash">=== osd.<span class="hljs-number">1</span> === 
create-or-move updated item name <span class="hljs-string">'osd.1'</span> weight <span class="hljs-number">0.03</span> at location {host=ceph-node3,root=default} to crush map
Starting Ceph osd.<span class="hljs-number">1</span> on ceph-node3...
Running as unit run-<span class="hljs-number">22695</span>.service.
=== osd.<span class="hljs-number">1</span> === 
Starting Ceph osd.<span class="hljs-number">1</span> on ceph-node3...already running
</code></pre>
</li>
<li><p>想在异地 Ceph 节点开启同一类型的后台程序：
例如 <code>ceph-node2</code> 运行了 osd.0，<code>ceph-node3</code> 上运行了 osd.1：</p>
<pre><code class="lang-bash">=== osd.<span class="hljs-number">1</span> === 
create-or-move updated item name <span class="hljs-string">'osd.1'</span> weight <span class="hljs-number">0.03</span> at location {host=ceph-node3,root=default} to crush map
Starting Ceph osd.<span class="hljs-number">1</span> on ceph-node3...
Running as unit run-<span class="hljs-number">23366</span>.service.
=== osd.<span class="hljs-number">0</span> === 
Starting Ceph osd.<span class="hljs-number">0</span> on ceph-node2...already running
=== osd.<span class="hljs-number">1</span> === 
Starting Ceph osd.<span class="hljs-number">1</span> on ceph-node3...already running
</code></pre>
</li>
</ul>
</li>
<li><p>关闭不同类型的后台程序：</p>
<ul>
<li><p>想在本地 Ceph 节点关闭同一类型的后台程序： 
例如 <code>ceph-node1</code> 上运行的是 mon：</p>
<pre><code class="lang-bash">=== mon.ceph-node1 === 
Stopping Ceph mon.ceph-node1 on ceph-node1...kill <span class="hljs-number">13239</span>...done
</code></pre>
</li>
<li><p>想在异地 Ceph 节点关闭同一类型的后台程序：
例如在 <code>ceph-node3</code> 上关闭 <code>ceph-node1</code> 上的 mon 程序：</p>
<pre><code class="lang-bash">[Ceph@ceph-node3 ~]$ <span class="hljs-built_in">sudo</span> /etc/init.d/ceph <span class="hljs-operator">-a</span> stop mon
=== mon.ceph-node1 === 
Stopping Ceph mon.ceph-node1 on ceph-node1...kill <span class="hljs-number">17739</span>...done
</code></pre>
</li>
</ul>
</li>
<li><p>开启具体的后台程序：</p>
<ul>
<li><p>开启本地节点上具体的某个 Ceph 后台程序
例如在 <code>ceph-node1</code> 上开启 mon：</p>
<pre><code class="lang-bash">[Ceph@ceph-node1 ~]$ <span class="hljs-built_in">sudo</span> /etc/init.d/ceph start mon.ceph-node1
=== mon.ceph-node1 === 
Starting Ceph mon.ceph-node1 on ceph-node1...
Running as unit run-<span class="hljs-number">18285</span>.service.
Starting ceph-create-keys on ceph-node1...
</code></pre>
</li>
<li><p>在异地节点开启具体的某个 Ceph 后台程序
例如在 <code>ceph-node1</code> 上开启 <code>ceph-node2</code> 上的 osd.0 程序：</p>
<pre><code class="lang-bash">[Ceph@ceph-node1 ~]$ <span class="hljs-built_in">sudo</span> /etc/init.d/ceph <span class="hljs-operator">-a</span> start osd.<span class="hljs-number">0</span>
=== osd.<span class="hljs-number">0</span> === 
Starting Ceph osd.<span class="hljs-number">0</span> on ceph-node2...already running
</code></pre>
</li>
</ul>
</li>
<li><p>关闭具体的后台程序：</p>
<ul>
<li><p>关闭本地节点上具体的某个 Ceph 后台程序
例如在 <code>ceph-node1</code> 上关闭 mon：     </p>
<pre><code class="lang-bash">[Ceph@ceph-node1 ~]$ <span class="hljs-built_in">sudo</span> /etc/init.d/ceph stop mon.ceph-node1
=== mon.ceph-node1 === 
Stopping Ceph mon.ceph-node1 on ceph-node1...kill <span class="hljs-number">18289</span>...done
</code></pre>
</li>
<li><p>在异地节点关闭具体的某个 Ceph 后台程序
例如在 <code>ceph-node1</code> 上关闭 <code>ceph-node2</code> 上的 osd.0 程序：</p>
<pre><code class="lang-bash">[Ceph@ceph-node1 ~]$ <span class="hljs-built_in">sudo</span> /etc/init.d/ceph <span class="hljs-operator">-a</span> stop osd.<span class="hljs-number">0</span>
=== osd.<span class="hljs-number">0</span> === 
Stopping Ceph osd.<span class="hljs-number">0</span> on ceph-node2...kill <span class="hljs-number">16701</span>...kill <span class="hljs-number">16701</span>...done
</code></pre>
</li>
</ul>
</li>
<li>ceph 作为一个服务来运行：</li>
</ol>
</li>
<li><p>监控 Ceph 集群：</p>
<ol>
<li>交互模式：</li>
<li>检查集群的健康状态：</li>
<li>观察集群：</li>
<li>观察集群的使用情况：</li>
<li>检查集群的状态：</li>
<li>检查集群的状态：</li>
<li>查看监控器的状态：</li>
<li>查看 MDS 的状态：</li>
<li>检查 placement group（放置组？）的状态：</li>
<li>是用 admin 套接字：</li>
</ol>
</li>
<li><h4 id='ExpandingCluster'>扩展集群</h4>
<h4 id='StoringRetrievingObjectData'>存储/获取对象数据</h4>
<h3 id='BlockDeviceQuickStart'>块设备之快速入门</h3>
<h4 id='CephInstallation'>安装 Ceph</h4>
<h4 id='ConfigureABlockDevice'>配置块设备</h4>

</li>
</ol>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../distributed/Ceph/README.html" class="navigation navigation-prev " aria-label="Previous page: Ceph"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../life/README.html" class="navigation navigation-next " aria-label="Next page: 生活"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
